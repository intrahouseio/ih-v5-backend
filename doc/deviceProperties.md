
## **Свойства устройств**

 - свойства-значения
 - свойства-команды

 ### **Свойства-значения**

Наследуются от типа

Имеют атрибуты:

  - тип значения: vtype = Boolean, Number, String

  - тип операции: op =  r,w,rw, calculate

  - функция обработки **При получении данных**

    Запускается перед записью значения в свойство, на входе получает значение
  
    Любое свойство  op=r (rw) имеет такую функцию, 
    если не определена - запускается дефолтная в зависимости от типа значения

    Возвращает значение свойства и/или ошибку. Может вернуть пустой объект - тогда входящее значение игнорируется, в качестве рабочего остается предыдущее значение.
    Хотя raw значение и ts изменяются

  - функция обработки **При получении данных** для свойств типа  **calculate**

    Запускается после любых? изменений свойств для чтения, TODO - Или по таймеру ?? 
    
    На входе получает изменения свойств данного блока приема данных (фронты изменений)

    Возвращаемое значение - аналогично. 
    Отличие в том, что во входящем блоке данных значение для свойства calculate игнорируется, оно всегда пересчитывается на основании обычных полей ??? 

    Как присвоить значение свойству calc напрямую? НИКАК
    Пример:
      reauto - при переключении state (и нек доп условиях) устанавливается
      Нужно сбросить по таймеру
      Варианты:
        - через команду set - попадаем в петлю??
        - обработчик взводит свой таймер, запускается по таймеру и все делает сам
    
    Обработчик изнутри?? может выполнить команду set, которая есть у свойств с op='rw'

    









